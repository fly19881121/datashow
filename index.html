<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>千方小贷业务数据监测</title>
  <meta name="description" content="">
  <meta name="keywords" content="">
  <link href="stylesheets/index.css" rel="stylesheet">

  <script src="jquery3.3.1.js"></script>

  <script src="digitalScroll.js"></script>


  <script src="echarts.js"></script>

</head>

<body>
  <div class="header clearix">
    <span class="">千方物流金融实时动态</span>
  </div>
  <div class="main">
    <div class="item-wrap-a">
      <div class="iwa-a">
        <h5>在线用户数</h5>
        <div class="totalnum totalnum-a">

        </div>
      </div>
      <div class="iwa-b">
        <h5>累计实名认证用户数</h5>
        <div class="totalnum totalnum-b">

        </div>
      </div>
      <div class="iwa-c">
        <h5>当日新增用户数</h5>
        <div class="totalnum totalnum-c">
        </div>
      </div>
      <div class="iwa-d">
        <h5>当日实名认证用户数</h5>
        <div class="totalnum totalnum-d">
        </div>
      </div>
    </div>
    <div class="item-wrap-b">
      <div class="item-wrap-bleft">
        <div class="iwb-a" id="iwb-a"></div>
        <div class="iwb-b" id="iwb-b"></div>
        <div class="iwb-c"></div>
      </div>
      <div class="item-wrap-bmiddle"></div>
      <div class="item-wrap-bright">
        <div class="iwb-d"></div>
        <div class="iwb-e"></div>
        <div class="iwb-f"></div>
      </div>
    </div>
  </div>


  <script src="jsfunction.min.js"></script>
  <script src="drawChart.js"></script>

  <script type="text/javascript">
    // function digital(){
    var sum = parseInt(Math.random() * 10000 + 1);
    var sum2 = parseInt(Math.random() * 1000 + 1);
    // }

    $(function () {
      userDaka();
      setInterval(userDaka, 60000);
    });

    function show_num1(n, ele) {
      sum = parseInt(Math.random() * 1000000 + 1);
      sum2 = parseInt(Math.random() * 1000 + 1);
      sum3 = parseInt(Math.random() * 1000 + 1);
      sum4 = parseInt(Math.random() * 1000 + 1);
      var $ele = $(ele);
      var it = $ele.find('i');
      var len = String(n).length;
      for (var i = 0; i < len; i++) {
        if (it.length <= i) {
          $ele.append("<i></i>");
        }
        var num = String(n).charAt(i);
        //根据数字图片的高度设置相应的值
        var y = -parseInt(num) * 58;
        var obj = $ele.find('i').eq(i);
        obj.animate({
          backgroundPosition: '(0 ' + String(y) + 'px)'
        }, 'slow', 'swing', function () {});
      }
    }




    function userDaka() {
      $.ajax({
        // cache:true,//保留缓存数据
        type: "get", //为post请求
        url: "http://103.10.87.52:1080/daka-api/rest/api/queryData", //这是我在后台接受数据的文件名
        success: function (result) {
          var cc = JSON.parse(result).body;
          let ccJson = eval('(' + cc + ')');
          show_num1(ccJson.onlineuser, '.totalnum-a');
          show_num1(ccJson.authen, '.totalnum-b');
          show_num1(ccJson.registernum, '.totalnum-c');
          show_num1(ccJson.authenAll, '.totalnum-d');
          ccJson.typeRatio_1 = 200;
          ccJson.typeRatio_2 = 400;
          ccJson.typeRatio_3 = 100;
          ccJson.typeRatio_4 = 600;
          ccJson.typeRatio_5 = 700;
          ccJson.typeRatio_6 = 4000;
          ccJson.typeRatio_7 = 800;
          ccJson.typeRatio_8 = 40;
          ccJson.typeRatio_9 = 90;        
          var pieData = [{
              name: '车主',
              value: ccJson.typeRatio_1
            },
            {
              name: '车队组织者',
              value: ccJson.typeRatio_2
            },
            {
              name: '驾驶员',
              value: ccJson.typeRatio_3
            },
            {
              name: '三方物流',
              value: ccJson.typeRatio_4
            },
            {
              name: '专线',
              value: ccJson.typeRatio_5
            },
            {
              name: '货主',
              value: ccJson.typeRatio_6
            },
            {
              name: '其它',
              value: ccJson.typeRatio_7+ccJson.typeRatio_8+ccJson.typeRatio_9
            },
          ];
          var pieOption = {
            tooltip: {
              trigger: 'item',
              formatter: function(p){
                console.log(p);
                return p.name+'<br/>'+p.value+'('+p.percent+'%)';
              }
            },
            legend: {
              orient: 'vertical',
              x: 'left',
              data: pieData.joinKey('name'),
              textStyle:{
                color:'#fff',
                fontSize:'14'
              }
            },
            series: [{
              type: 'pie',
              center:['70%','50%'],
              radius: ['50%', '75%'],
              avoidLabelOverlap: false,
              hoverAnimation:false,
              label: {
                normal: {
                  show: false,
                  position: 'center'
                },
                emphasis: {
                  show: false,
                  textStyle: {
                    fontSize: '20',
                    fontWeight: 'bold'
                  }
                }
              },
              labelLine: {
                normal: {
                  show: false
                }
              },
              data: pieData
            }]
          }
          drawChart('iwb-a',pieOption);
        },
        error: function (e) {
          console.log(e);
        }
      });
    }
  </script>





</body>

</html>